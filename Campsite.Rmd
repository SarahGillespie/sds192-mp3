---
title: "Campsite"
author: "Sarah Gillespie, Berry Williams, Eva Putnam"
date: "2019-05-15"
output:
  html_document:
    code_folding: hide
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r StartingItems, message=FALSE, warning = FALSE}
library(tidyverse)
library(macleish)
library(sf)
library(leaflet)
library(dplyr)
library(lwgeom)
library(wordcountaddin)
```

> Word count: `r wordcountaddin::word_count()`

# words

```{r Code, message=FALSE, warning = FALSE}

new_campsite<- tribble(
  ~name, ~lat, ~lon,
  "New campsite 1", 42.448483, -72.675119,
  "New campsite 2", 42.447339, -72.675275)

existing_campsites <- tribble(
  ~name, ~lat, ~lon,
  "Group campsite", 42.450933, -72.677843,
   "Remote campsite", 42.458811, -72.680851)

#icons from https://www.nps.gov/maps/tools/symbol-library/

new_campsite_icon <- icons(
  iconUrl = "https://www.nps.gov/maps/tools/symbol-library/assets/img/campground-black-22.svg")

existing_campsite_icon <- icons(
  iconUrl = "https://www.nps.gov/maps/tools/symbol-library/assets/img/campsite-black-22.svg")

html_legend <- "<img src='https://www.nps.gov/maps/tools/symbol-library/assets/img/campground-black-22.svg'>Proposed campsite<br/>
<img src='https://www.nps.gov/maps/tools/symbol-library/assets/img/campsite-black-22.svg'>Existing campsite"

macleish_layers %>%
  pluck("trails") %>%
  st_length()

trails <- macleish_layers %>%
  pluck("trails") %>%
  mutate(computed_length = st_length(geometry))

macleish_layers %>%
  pluck("boundary") %>%
  st_area()

proj4_aea <- "+proj=aea +lat_1=29.5 +lat_2=45.5 +lat_0=37.5 +lon_0=-96 +x_0=0 +y_0=0 +ellps=GRS80 +datum=NAD83 +units=m +no_defs"

boundaries_aea <- macleish_layers %>%
  pluck("boundary") %>%
  st_transform(proj4_aea)

macleish_layers %>%
  pluck("trails") %>%
  st_intersects(pluck(macleish_layers ,"streams"))



stream_buffer <- macleish_layers %>%
  pluck("streams") %>%
  st_transform(proj4_aea) %>%
  st_buffer(dist = 5) %>%
  st_transform(4326)

contours_buffer <- macleish_layers %>%
  pluck("contours_3m") %>%
  st_transform(proj4_aea) %>%
  st_buffer(dist = .1) %>%
  st_transform(4326)

leaflet() %>%
  addTiles() %>%
  addPolylines(data = pluck(macleish_layers, "streams"), 
               weight = 1, color = "black") %>%
  addPolygons(data = stream_buffer) %>% 
  addPolylines(data = pluck(macleish_layers, "trails"), color = "brown") %>%
  addPolylines(data = pluck(macleish_layers, "contours_3m"), color = "green") %>%
  addMarkers(data = new_campsite, icon = new_campsite_icon, popup = "Proposed campsites") %>%
  addMarkers(data = existing_campsites, icon = existing_campsite_icon, popup = ~name) %>%
  addControl(html = html_legend, position = "bottomleft")
  
```



^[[Github Repository](https://github.com/SarahGillespie/sds192-mp3)
]